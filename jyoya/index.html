<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <style>
    body{
      text-align: center;
      font-family: "Hiragino Sans W3", "Hiragino Kaku Gothic ProN", "ヒラギノ角ゴ ProN W3", "ＭＳ Ｐゴシック", "MS PGothic", arial, "Helvetica Neue", "Helvetica", "Yu Gothic";
      background-color: linen;
    }
  </style>
</head>
<!-- by the son of the head of HONGANJI, Hiroaki -->
<body>
  <p style="font-size: 5vw;">除夜の鐘 2025&gt;2026</p>
  <p style="font-size: 10vw;"><span id="nowNumber"></span>回</p>
  <p style="font-size: 5vw;">現在時刻: <span id="timetext"></span></p>
  <p style="font-size: 3vw;">HONGANJI: Tottori City, Tottori Prefecture, JAPAN</p>
  <script type="text/javascript">
    const url = "https://docs.google.com/spreadsheets/d/1HijQK_3wA5z1uy9BBawe1EAEAxorlyP2yJKqyyN_Xdk/gviz/tq?tqx=out:json&sheet=25to26&range=A1";
    showTime();
    loadNumber();
    function showTime() {
      var now = new Date();
      var nowyear = now.getFullYear();
      var nowmonth = now.getMonth() + 1;
      if (nowmonth < 10) {
        var nowmonth = '0' + String(nowmonth);
      }
      var nowday = now.getDate();
      if (nowday < 10) {
        var nowday = '0' + String(nowday);
      }
      var nowhour = now.getHours();
      if (nowhour < 10) {
        var nowhour = '0' + String(nowhour);
      }
      var nowminutes = now.getMinutes();
      if (nowminutes < 10) {
        var nowminutes = '0' + String(nowminutes);
      }
      var nowseconds = now.getSeconds();
      if (nowseconds < 10) {
        var nowseconds = '0' + String(nowseconds);
      }
      var text = nowyear + "年 " + nowmonth + "/" + nowday + " " + nowhour + ":" + nowminutes + ":" + nowseconds; 
      document.getElementById("timetext").innerHTML = text;
    }
    async function loadNumber() {
      const res = await fetch(url);
      const text = await res.text();
      const json = JSON.parse(text.substring(47).slice(0, -2));
      const value = json.table.rows[0].c[0].v;
      document.getElementById("nowNumber").innerText = value;
    }
    setInterval(showTime, 990);
    setInterval(loadNumber, 990);
  </script>
</body>
</html>
